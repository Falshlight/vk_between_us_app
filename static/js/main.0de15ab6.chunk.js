(this.webpackJsonpdating_app=this.webpackJsonpdating_app||[]).push([[0],{129:function(e,t,n){e.exports=n.p+"static/media/icon.a8534fd6.svg"},215:function(e,t,n){e.exports=n(347)},305:function(e,t,n){},347:function(e,t,n){"use strict";n.r(t);n(216),n(242),n(244),n(245),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284);var a=n(0),c=n.n(a),o=n(126),r=n.n(o),i=n(25),s=n.n(i),l=n(141),u=n(47),d=n.n(u),f=n(59),m=n(18),h=n(75),p=n.n(h),b=n(138),g=n.n(b),v=(n(293),n(132)),E=n.n(v),j=n(133),O=n.n(j),_=n(82),k=n.n(_),y=n(136),x=n.n(y),C=n(131),S=n.n(C),w=n(130),I=n.n(w),M=n(35),A="https://flashlightservice.ml:5000/";function N(){return(N=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.send("VKWebAppCallAPIMethod",{method:"friends.get",request_id:"32test",params:{v:"5.124",access_token:t,count:1e4,fields:"first_name,last_name,sex,bdate,photo_100",order:"name"}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=function(e){return N.apply(this,arguments)},U=(n(305),n(135)),V=n.n(U),K=n(134),W=n.n(K),L=n(137),P=n.n(L),F=n(41),R=n.n(F),q=n(129),z=n.n(q),G=(n(119),function(e){var t=e.id,n=e.fetchedUser,o=e.hash,r=e.optionsList,i=e.setActiveModal,s=e.friends,l=e.setUpd,u=e.openModalCard,d=e.setFilter,f=e.filter,h=Object(a.useState)(""),p=Object(m.a)(h,2),b=p[0],g=p[1],v=r;function j(e){try{for(var t=0;t<s.length&&s[t].id!==e;t++);if(s[t].options.length){for(var n=[],a=0;a<s[t].options.length;a++){var c=s[t].options[a];n.push(v[c.index-1])}return n.join(", ")}return"\u041d\u0435\u0442 \u0441\u0432\u043e\u0439\u0441\u0442\u0432"}catch(o){}}function _(e){try{for(var t=0;t<s.length&&s[t].id!==e;t++);if(s[t].options.length){for(var n=[],a=0;a<s[t].options.length;a++){var c=s[t].options[a];c.show&&n.push(v[c.index-1])}return n.length?"\u0421\u043e\u0432\u043f\u0430\u043b\u043e: "+n.join(", "):""}return""}catch(o){}}return c.a.createElement(E.a,{id:t},c.a.createElement(O.a,{left:c.a.createElement(k.a,{className:"header-button",mode:"tertiary",onClick:function(){u(null)}},"\u0412\u0441\u0435\u0445 \u043b\u044e\u0431\u043b\u044e")},"\u041c\u0435\u0436\u0434\u0443 \u043d\u0430\u043c\u0438"),c.a.createElement(W.a,{value:b,onChange:function(e){g(e.target.value)},icon:c.a.createElement(V.a,null),onIconClick:function(){i("modal")}}),c.a.createElement(x.a,{className:"friend-list"},c.a.createElement(P.a,null,function(){var e=[],t=!1,a=s;if(b){var r=b.toLowerCase();a=s.filter((function(e){return(e.first_name+" "+e.last_name).toLowerCase().indexOf(r)>-1}))}for(var i=0;i<a.length;i++){var m=a[i];if(!m.options)return;var h=m.options.map((function(e){return e.show&&!e.checked?1:0})).includes(1);h&&(t=!0),e.push(c.a.createElement(I.a,{before:c.a.createElement(S.a,{"data-id":i,size:48,src:m.photo_100,className:h?"new-match":"no-new-match"}),multiline:!0,className:"user-cell","data-uid":m.id,caption:_(m.id),actions:c.a.createElement(c.a.Fragment,null,c.a.createElement(k.a,{mode:"secondary",onClick:u,"data-ind":i,"data-id":m.id},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",c.a.createElement("span",{"data-ind":i,"data-id":m.id}))),text:j(m.id),onClick:function(e){if(console.log(e),e.target.dataset&&e.target.dataset.id){var t=e.target.dataset.id;R.a.get(A+"check?uid="+n.id+"&check_id="+a[t].id+"&uid="+n.id+"&hash="+o).then((function(e){l(Math.random())}))}}},m.first_name+" "+m.last_name))}return function(e){var t=document.getElementById("header-circle");if(t&&t.remove(),e){(t=document.createElement("img")).id="header-circle",t.src=z.a,t.onclick=function(){f.only_match?d({sex:0,age:{from:1,to:100},only_match:!1}):d({sex:0,age:{from:1,to:100},only_match:!0}),l(Math.random())};var n=document.getElementsByClassName("PanelHeader__content")[1];n||(n=document.getElementsByClassName("PanelHeader__content")[0]),n.appendChild(t);var a=t.getBoundingClientRect();console.log(a)}else;}(t),e}())))}),H=n(140),J=n.n(H),T=n(83),$=n.n(T),D=n(76),Q=n.n(D),X=n(139),Y=n.n(X),Z=n(77),ee=n.n(Z),te=n(78),ne=n.n(te),ae=n(79),ce=n.n(ae),oe=n(80),re=n.n(oe),ie=n(81),se=n.n(ie),le=Object(M.g)(),ue=le===M.c,de=le===M.a;function fe(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}var me=n(119),he=function(){var e=Object(a.useState)("home"),t=Object(m.a)(e,2),n=t[0],o=(t[1],Object(a.useState)(null)),r=Object(m.a)(o,2),i=r[0],u=r[1],h=Object(a.useState)(""),b=Object(m.a)(h,2),v=b[0],E=b[1],j=Object(a.useState)(c.a.createElement(g.a,{size:"large"})),O=Object(m.a)(j,2),_=O[0],k=O[1],y=Object(a.useState)([]),x=Object(m.a)(y,2),C=x[0],S=x[1],w=Object(a.useState)([]),I=Object(m.a)(w,2),N=I[0],U=I[1],V=Object(a.useState)(0),K=Object(m.a)(V,2),W=(K[0],K[1],Object(a.useState)({sex:"a",age:{from:1,to:100},only_match:!1})),L=Object(m.a)(W,2),P=L[0],F=L[1],q=Object(a.useState)(""),z=Object(m.a)(q,2),H=z[0],T=z[1],D=Object(a.useState)(null),X=Object(m.a)(D,2),Z=X[0],te=X[1],ae=Object(a.useState)(P.sex),oe=Object(m.a)(ae,2),ie=oe[0],le=oe[1],he=Object(a.useState)(P.age.from),pe=Object(m.a)(he,2),be=pe[0],ge=pe[1],ve=Object(a.useState)(P.age.to),Ee=Object(m.a)(ve,2),je=Ee[0],Oe=Ee[1],_e=Object(a.useState)(P.only_match),ke=Object(m.a)(_e,2),ye=ke[0],xe=ke[1],Ce=Object(a.useState)([]),Se=Object(m.a)(Ce,2),we=Se[0],Ie=Se[1],Me=Object(a.useState)(0),Ae=Object(m.a)(Me,2),Ne=Ae[0],Be=Ae[1],Ue=Object(a.useState)(0),Ve=Object(m.a)(Ue,2),Ke=Ve[0],We=Ve[1];function Le(){Be(Math.random())}Object(a.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.send("VKWebAppGetUserInfo");case 2:return t=e.sent,u(t),e.next=6,s.a.send("VKWebAppGetAuthToken",{app_id:7602116,scope:"friends"});case 6:n=e.sent,E(n.access_token),R.a.get(A+"auth?at="+n.access_token+"&uid="+t.id).then((function(e){T(e.data)})),k(null),a=fe("vk_are_notifications_enabled",null),console.log("N:",a),a&&parseInt(a)||s.a.send("VKWebAppAllowNotifications").then((function(e){console.log(e)}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s.a.subscribe((function(e){var t=e.detail,n=t.type,a=t.data;if("VKWebAppUpdateConfig"===n){var c=document.createAttribute("scheme");c.value=a.scheme?a.scheme:"client_light",document.body.attributes.setNamedItem(c)}})),function(){e.apply(this,arguments)}()}),[]),Object(a.useEffect)((function(){le(P.sex),ge(P.age.from),Oe(P.age.to),xe(P.only_match)}),[P]),Object(a.useEffect)((function(){F({sex:ie,age:{from:be,to:je},only_match:ye})}),[ie,be,je,ye]),Object(a.useEffect)((function(){R.a.get(A+"get-options").then((function(e){U(e.data)}))}),[]),Object(a.useEffect)((function(){v.length&&B(v).then((function(e){Ie(e.response.items)}))}),[v]),Object(a.useEffect)((function(){i&&(console.log("upda"),R.a.post(A+"get-friends?uid="+i.id+"&hash="+H,{friends:we,uid:i.id,filter:P}).then((function(e){console.log(e.data),me.isEqual(e.data,C)||S(e.data)})).catch((function(){Be(Math.random())})))}),[we,Ne]),Object(a.useEffect)((function(){return setInterval(Le,1e4),function(){clearInterval(Le)}}),[]);function Pe(){Be(Math.random()),te(null)}var Fe=c.a.createElement(M.f,{activeModal:Z,onClose:Pe},c.a.createElement(M.e,{id:"modal",onClose:Pe,header:c.a.createElement(Y.a,{left:de&&c.a.createElement($.a,{onClick:Pe},c.a.createElement(Q.a,null)),right:c.a.createElement($.a,{onClick:Pe},ue?"\u0413\u043e\u0442\u043e\u0432\u043e":c.a.createElement(J.a,null))},"\u0424\u0438\u043b\u044c\u0442\u0440\u044b")},c.a.createElement(M.b,null,c.a.createElement(ee.a,{top:"\u041f\u043e\u043b",value:ie,onChange:function(e){le(e.target.value)}},c.a.createElement("option",{value:"a"},"\u041b\u044e\u0431\u043e\u0439"),c.a.createElement("option",{value:"m"},"\u041c\u0443\u0436\u0441\u043a\u043e\u0439"),c.a.createElement("option",{value:"f"},"\u0416\u0435\u043d\u0441\u043a\u0438\u0439")),c.a.createElement(ne.a,{top:"\u0412\u043e\u0437\u0440\u0430\u0441\u0442",min:1,max:100,step:1,defaultValue:[be,je],onChange:function(e){ge(e[0]),Oe(e[1])},bottom:"\u041e\u0442 "+be+" \u0434\u043e "+je}),c.a.createElement(ce.a,{asideContent:c.a.createElement(re.a,{id:"only-match",checked:ye,onChange:function(e){xe(e.target.checked)}})},"\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f"))),c.a.createElement(M.d,{id:"friend-options",className:"tst",header:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430",onClose:function(){te(null)},actions:[{title:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c",mode:"primary",action:function(){for(var e=[],t=0;t<N.length;t++){var n=document.getElementById("checkbox-"+t);n.checked&&e.push(t+1),n.checked=!1}if(null!=Ke)R.a.post(A+"set-options?uid="+i.id+"&hash="+H,{to:Ke,from:i.id,options:e}).then((function(){Be(Math.random())}));else{var a=Object(l.a)(document.getElementsByClassName("user-cell")).map((function(e){return parseInt(e.dataset.uid)}));R.a.post(A+"set-options?uid="+i.id+"&hash="+H,{to:a,from:i.id,options:e}).then((function(){Be(Math.random())}))}Pe()}}]},c.a.createElement(M.b,null,function(){for(var e=[],t=0;t<N.length;t++)e.push(c.a.createElement(se.a,{id:"checkbox-"+t,key:"checkbox-"+t},N[t]));return e}())));return c.a.createElement(p.a,{activePanel:n,popout:_,modal:Fe},c.a.createElement(G,{id:"home",fetchedUser:i,hash:H,optionsList:N,setActiveModal:te,friends:C,setUpd:Be,openModalCard:function(e){if(e){e.target.children[0].dataset.ind;var t=e.target.children[0].dataset.id;console.log(t);for(var n=0;n<C.length&&C[n].id!==parseInt(t);n++);var a=C[n];if(!a)return;var c=a.options;We(t),setTimeout((function(){for(var e=0;e<c.length;e++){var t=c[e].index;document.getElementById("checkbox-"+(t-1)).checked=!0}}),100)}else We(null);te("friend-options")},setFilter:F,filter:P}))};s.a.send("VKWebAppInit"),r.a.render(c.a.createElement(he,null),document.getElementById("root"))}},[[215,1,2]]]);
//# sourceMappingURL=main.0de15ab6.chunk.js.map